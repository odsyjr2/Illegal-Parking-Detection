# 📍 실시간 불법주정차 단속 출동 경로 추천 시스템

## 🧠 시스템 개요

본 시스템은 CCTV 기반 실시간 불법주정차 탐지 데이터를 활용하여, **단속원이 제한된 시간/거리 내에 출동하여 최대한 많은 위반 차량을 단속**할 수 있도록 **실시간 경로를 추천**하는 AI 기반 단속 지원 시스템입니다.

단속원이 도착하기 전까지 시간이 지날수록 단속 성공 확률이 감소한다는 가정을 기반으로, 실시간성과 탐지 중요도를 모두 고려한 **Orienteering Problem 기반 경로 최적화** 방식으로 설계되었습니다.

---

## 🔧 시스템 구성

### 1. 실시간 탐지 모듈
- CCTV가 탐지한 불법주정차 차량 데이터를 수집
- 탐지 시각, CCTV 위치, 탐지 ID 등을 포함
- 📄 `CCTV기반단속개별건수.csv`

### 2. 과거 단속 이력 분석 모듈
- 실제 단속 성공 여부 및 탐지~도착 간격 분석
- 시간 경과에 따른 단속 성공 확률 모델링에 사용
- 📄 `일반단속개별건수_geocoded.csv`

### 3. 단속 성공 확률 예측 모델
- 탐지 후 경과 시간 `t`에 따라 단속 성공 확률 `p(t)` 추정
- 예시 모델: `p(t) = exp(-λt)`
- 회귀 모델로 정밀 예측 가능

### 4. 실시간 노드 가중치 계산
- 각 탐지 위치 노드에 대해 `final_weight = p(t)` 설정
- 시간이 지날수록 단속 가치가 감소

### 5. 도로망 그래프 구성
- `osmnx`를 이용하여 서초구 도로망 네트워크 구축
- 각 CCTV 탐지 위치를 그래프의 노드로 매핑
- 노드 간 최단 거리(`edge["length"]`) 계산

### 6. 출동 경로 최적화 (OR-Tools)
- 단속 차량 수와 최대 이동 거리(또는 시간)를 입력받아,
- 단속 성공 확률의 총합(`∑ final_weight`)이 최대가 되도록 경로 탐색
- `Orienteering Problem` 형태로 모델링하여 해결

---

## ⚙️ 핵심 알고리즘 요소

- **노드(탐지 위치)**:
  - CCTV 탐지 위치의 위/경도
  - `final_weight`: 실시간 단속 성공 확률로 설정

- **엣지(이동 경로)**:
  - 실제 도로망 기반 최단 거리(`length`)

- **목적 함수**:
  - 제한 거리 또는 시간 내에 최대한 많은 단속 위치를 방문하여
  - `∑ final_weight` (단속 성공 기대치)를 최대화

- **최적화 기법**:
  - OR-Tools 기반 `RoutingModel`
  - Orienteering Problem (profit-based routing)

---

## 📈 기대 효과

- 🚓 수동 단속이 필요한 상황에서 빠른 출동 경로 추천
- 🧠 실시간성과 과거 통계 기반 단속 우선순위 판단
- 🔁 지속적인 데이터 학습을 통한 단속 효율 향상
- 💡 단속 건수 증가 및 민원 감소 효과 기대

---

## 🗂️ 주요 파일 구성 (예정)

| 파일명 | 설명 |
|--------|------|
| `cctv_detect_processor.py` | 실시간 탐지 데이터 전처리 및 노드 생성 |
| `success_model.py` | 경과 시간 → 단속 성공 확률 모델 |
| `build_graph.py` | osmnx 도로망 그래프 생성 및 거리 계산 |
| `orienteering_solver.py` | OR-Tools 기반 경로 최적화 |
| `run_main.py` | 전체 시스템 실행 파이프라인 |

---

## 🛠 향후 발전 방향

- 📡 CCTV 영상 실시간 연동
- 🤖 단속 성공 확률의 ML 기반 예측 모델 정교화
- 🗺️ 지도 기반 실시간 시각화 시스템 연동
